# 實作計畫

- [x] 1. 建立資料庫結構和模型

  - 建立 tribal_classifications 資料表遷移檔案
  - 建立 capture_records 資料表遷移檔案
  - 建立 TribalClassification 模型和關聯
  - 建立 CaptureRecord 模型和關聯
  - 擴展 Fish 模型新增關聯方法
  - _需求: 1.1, 2.1, 3.1, 4.1_

- [x] 2. 實作部落分類 API 端點

  - [x] 2.1 建立 TribalClassificationController

    - 實作 index 方法（取得魚類部落分類）
    - 實作 store 方法（新增部落分類）
    - 實作 update 方法（更新部落分類）
    - 實作 destroy 方法（刪除部落分類）
    - _需求: 3.1, 4.1, 6.1_

  - [x] 2.2 建立表單驗證請求類別

    - 建立 TribalClassificationRequest 驗證類別
    - 定義驗證規則和錯誤訊息
    - _需求: 3.3, 4.4_

  - [x] 2.3 設定 API 路由
    - 新增部落分類相關路由
    - 設定路由群組和中介軟體
    - _需求: 3.1, 4.1_

- [ ] 3. 實作捕獲紀錄 API 端點

  - [ ] 3.1 建立 CaptureRecordController

    - 實作 index 方法（取得魚類捕獲紀錄）
    - 實作 store 方法（新增捕獲紀錄）
    - 實作 update 方法（更新捕獲紀錄）
    - 實作 destroy 方法（刪除捕獲紀錄）
    - _需求: 12.1, 13.1, 14.1_

  - [ ] 3.2 建立捕獲紀錄表單驗證

    - 建立 CaptureRecordRequest 驗證類別
    - 處理圖片上傳驗證
    - _需求: 13.3, 13.5_

  - [ ] 3.3 整合 Supabase 圖片上傳
    - 擴展現有的 SupabaseStorageService
    - 處理捕獲紀錄圖片上傳和刪除
    - _需求: 13.2, 14.2_

- [ ] 4. 實作搜尋和篩選功能

  - [ ] 4.1 擴展魚類搜尋 API

    - 新增部落篩選參數
    - 新增飲食分類篩選參數
    - 新增處理方式篩選參數
    - 新增捕獲地點篩選參數
    - _需求: 7.1, 8.1, 9.1, 15.1_

  - [ ] 4.2 建立搜尋服務類別
    - 建立 FishSearchService 處理複雜搜尋邏輯
    - 實作查詢建構器方法
    - _需求: 7.1, 8.1, 9.1_

- [ ] 5. 建立前端部落分類元件

  - [ ] 5.1 建立 ClassificationForm 元件

    - 實作部落選擇下拉選單
    - 實作飲食分類選擇下拉選單
    - 實作處理方式選擇下拉選單
    - 實作調查備註文字區域
    - 處理表單提交和驗證
    - _需求: 3.1, 4.1_

  - [ ] 5.2 建立 ClassificationList 元件

    - 顯示魚類所有部落分類資料
    - 實作編輯和刪除功能
    - 實作備註展開/收合功能
    - _需求: 1.1, 6.1, 11.1_

  - [ ] 5.3 建立 ComparisonView 元件
    - 實作部落間比較檢視
    - 並排顯示不同部落資訊
    - _需求: 5.1, 5.2_

- [ ] 6. 建立前端捕獲紀錄元件

  - [ ] 6.1 建立 RecordForm 元件

    - 實作圖片上傳功能
    - 實作部落、地點、捕獲方式輸入
    - 處理表單提交和驗證
    - _需求: 13.1, 13.2_

  - [ ] 6.2 建立 RecordCard 元件

    - 顯示捕獲紀錄卡片
    - 實作圖片顯示和放大功能
    - 顯示捕獲資訊
    - _需求: 12.2, 12.3_

  - [ ] 6.3 建立 CaptureRecords 頁面
    - 整合 RecordForm 和 RecordCard 元件
    - 實作捕獲紀錄列表顯示
    - 處理新增、編輯、刪除操作
    - _需求: 12.1, 13.1, 14.1_

- [ ] 7. 擴展現有魚類頁面

  - [ ] 7.1 擴展 Fish/Show.vue 頁面

    - 新增部落分類資訊顯示區塊
    - 新增捕獲紀錄連結
    - 整合 ComparisonView 元件
    - _需求: 1.1, 2.1, 5.1, 12.1_

  - [ ] 7.2 擴展 Fish/Edit.vue 頁面
    - 新增部落資料管理區塊
    - 整合 ClassificationForm 和 ClassificationList 元件
    - 處理部落資料的新增、編輯、刪除
    - _需求: 3.1, 4.1, 6.1_

- [ ] 8. 實作搜尋和篩選介面

  - [ ] 8.1 建立 FilterPanel 元件

    - 實作部落篩選下拉選單
    - 實作飲食分類篩選下拉選單
    - 實作處理方式篩選下拉選單
    - 實作地點搜尋輸入框
    - _需求: 7.1, 8.1, 9.1, 15.1_

  - [ ] 8.2 擴展 SearchResults 元件

    - 顯示搜尋結果中的部落資訊
    - 突出顯示符合條件的資訊
    - 處理無結果狀態
    - _需求: 7.2, 8.4, 15.3_

  - [ ] 8.3 擴展 Fish/Search.vue 頁面
    - 整合 FilterPanel 和 SearchResults 元件
    - 實作即時搜尋功能
    - 處理搜尋條件變更
    - _需求: 7.4, 8.3, 9.4_

- [ ] 9. 實作批量編輯功能

  - [ ] 9.1 建立批量編輯 API 端點

    - 實作 batchUpdateTribal 方法
    - 處理多筆資料同時更新
    - 實作錯誤處理和回滾機制
    - _需求: 16.1, 16.2_

  - [ ] 9.2 建立批量編輯前端介面
    - 實作多選魚類功能
    - 建立批量編輯表單
    - 處理批量操作結果顯示
    - _需求: 16.3, 16.4, 16.5_

- [ ]\* 10. 撰寫測試

  - [ ]\* 10.1 撰寫後端單元測試

    - 測試 TribalClassification 模型關聯
    - 測試 CaptureRecord 模型關聯
    - 測試驗證規則
    - _需求: 所有後端功能_

  - [ ]\* 10.2 撰寫後端功能測試

    - 測試部落分類 API 端點
    - 測試捕獲紀錄 API 端點
    - 測試搜尋功能
    - 測試批量編輯功能
    - _需求: 所有 API 功能_

  - [ ]\* 10.3 撰寫前端元件測試
    - 測試 ClassificationForm 元件
    - 測試 RecordForm 元件
    - 測試 FilterPanel 元件
    - 測試使用者互動
    - _需求: 所有前端元件_

- [ ] 11. 資料庫最佳化和部署準備

  - [ ] 11.1 建立資料庫索引

    - 在 fish_id, tribe 欄位建立索引
    - 建立搜尋常用欄位的複合索引
    - _需求: 效能最佳化_

  - [ ] 11.2 設定快取機制

    - 快取部落和分類選項列表
    - 快取常用搜尋結果
    - _需求: 效能最佳化_

  - [ ] 11.3 更新環境配置
    - 更新 Supabase 儲存桶設定
    - 設定檔案上傳限制
    - 新增必要的環境變數
    - _需求: 部署準備_
