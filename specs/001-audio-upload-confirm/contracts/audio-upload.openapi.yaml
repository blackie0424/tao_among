openapi: 3.0.3
info:
  title: Audio Upload Confirm API
  version: 1.0.0
paths:
  /prefix/api/upload/audio/sign:
    post:
      summary: Create a signed upload URL for pending audio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [fish_id]
              properties:
                fish_id:
                  type: integer
                  minimum: 1
                ext:
                  type: string
                  description: Optional file extension (e.g., webm, mp3)
      responses:
        '200':
          description: Signed URL created
          content:
            application/json:
              schema:
                type: object
                required: [uploadUrl, filePath, expiresIn]
                properties:
                  uploadUrl:
                    type: string
                    format: uri
                    description: 絕對簽名網址（以 Supabase 網域開頭的 https URL）
                    example: https://your-project-ref.supabase.co/storage/v1/object/upload/sign/your-bucket/pending/audio/2025/11/01/1-uuid.webm?token=eyJ...
                  filePath:
                    type: string
                    example: pending/audio/2025/11/01/uuid.webm
                    description: 暫存路徑（僅供 confirm 使用），不包含網域
                  expiresIn:
                    type: integer
                    description: 簽名網址有效秒數
        '500':
          description: Failed to create signed URL
